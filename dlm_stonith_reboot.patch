diff -dur dlm-3.99.5.orig/fence/stonith_helper.c dlm-3.99.5/fence/stonith_helper.c
--- dlm-3.99.5.orig/fence/stonith_helper.c	2012-11-02 09:29:05.000000000 +0100
+++ dlm-3.99.5/fence/stonith_helper.c	2012-11-02 09:28:51.000000000 +0100
@@ -16,6 +16,7 @@
 
 int nodeid;
 uint64_t fail_time;
+int turn_off=1;
 
 #define MAX_ARG_LEN 1024
 
@@ -26,6 +27,11 @@
 	char val[MAX_ARG_LEN];
 	char c;
 	int rv;
+	int arg0_l;
+
+	arg0_l = strlen(argv[0]);
+	if (arg0_l>7 && !strcmp(argv[arg0_l-7], "_reboot")) turn_off=0;
+	else if (arg0_l>4 && !strcmp(argv[arg0_l-4], "_off")) turn_off=1;
 
 	if (argc > 1) {
 		while ((c = getopt(argc, argv, "n:t:")) != -1) {
@@ -77,7 +83,7 @@
 	if (t >= fail_time)
 		return 0;
 
-	rv = stonith_api_kick_helper(nodeid, 300, 1);
+	rv = stonith_api_kick_helper(nodeid, 300, turn_off);
 	if (rv) {
 		fprintf(stderr, "kick_helper error %d nodeid %d\n", rv, nodeid);
 		openlog("stonith_helper", LOG_CONS | LOG_PID, LOG_DAEMON);
